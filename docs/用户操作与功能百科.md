# WordSmith AI 用户操作与功能百科

> **版本**：1.0.0
> **适用对象**：最终用户
> **文档用途**：软件分发与软著申请操作手册

---

## 一、软件简介

**WordSmith AI（智排精灵）** 是一款专为学术文档与 AI 写作场景设计的智能排版桌面应用。它通过独创的 **"AI → HTML（Inline CSS）→ 剪贴板 → Word"** 技术链路，彻底解决了两大行业痛点：

1. **Word 公式难调**：AI 生成的 LaTeX 公式无法直接被 Word 识别，本软件内置 VBA 宏一键转换方案。
2. **AI 格式乱跳**：复制 AI 内容到 Word 时样式丢失、表格错乱，本软件通过 Inline CSS 守卫技术确保格式 100% 保留。

**核心特色**：
- **三栏沉浸式布局**：智囊配置、智能编辑、实时预览一屏尽览
- **数学公式优化**：完美支持 LaTeX 语法，配合 VBA 宏实现 Word 原生公式渲染
- **定制化排版**：字体、字号、模板全局可控，满足学术论文严格规范

[此处插入 UI 截图：软件主界面全貌]

---

## 二、界面布局导航

WordSmith AI 采用经典的三栏式布局设计，配合左侧全局导航栏，让您在一个界面内完成从配置到生成再到预览的完整工作流。

### 2.1 全局导航栏（最左侧）

位于窗口最左侧的垂直导航栏，宽度 64 像素，包含以下功能入口：

| 图标 | 功能 | 说明 |
|------|------|------|
| ✨ | 品牌标识 | WordSmith AI 图标 |
| ➕ | 新建对话 | 开启全新的排版任务（当前有对话时可用） |
| 📄 | 首页 | 返回主编辑界面 |
| 🕐 | 历史记录 | 查看和管理所有历史对话 |
| ⚙️ | 设置 | 配置 AI 模型、排版参数等 |
| ❓ | 帮助中心 | 查阅使用指南与常见问题 |

[此处插入 UI 截图：全局导航栏特写]

---

### 2.2 左侧：智囊配置区

**功能定位**：为 AI 提供持久化的"人设"与参考资料，让生成结果更贴合您的需求。

#### 自定义指令

在「自定义指令」文本框中输入长效指令，这些指令将在每次对话中自动注入给 AI。

**使用场景示例**：
- "所有标题使用黑体，正文使用宋体"
- "表格边框使用 0.5pt 细线"
- "段落首行缩进 2 字符"

#### 参考文档

点击「上传文档」按钮，可上传 `.txt` 或 `.md` 格式的参考文件。AI 将学习这些文档的风格与内容，生成更符合您预期的排版结果。

**支持格式**：`.txt`、`.md`（如需上传 PDF/Word，请先提取文字内容）

[此处插入 UI 截图：智囊配置区展开状态]

---

### 2.3 中间：智能编辑区

**功能定位**：与 AI 对话的核心工作区，支持内容生成与文档纠错两种模式。

#### 对话消息区

- **用户消息**：显示在右侧，深色背景
- **AI 回复**：显示在左侧，浅色背景
- **调试按钮**（🐛）：点击可查看发送给 AI 的完整指令（详见第四章）

#### 模式切换

底部提供两个模式切换按钮：
- **生成**（✨）：从零开始创建新内容
- **纠错**（🔧）：对现有内容进行润色修正

#### 输入区

在底部输入框中描述您的需求，按 Enter 发送（Shift + Enter 换行）。

[此处插入 UI 截图：智能编辑区对话界面]

---

### 2.4 右侧：实时预览区

**功能定位**：所见即所得的排版预览，确保复制到 Word 后的效果与预期一致。

#### 工具栏按钮（从左到右）

| 图标 | 功能 | 说明 |
|------|------|------|
| `</>` | 源码视图 | 切换显示原始 HTML 代码 |
| 🔄 | 刷新预览 | 重新渲染当前内容 |
| ⛶ | 全屏预览 | 在大窗口中查看完整效果 |
| ↗️ | 新窗口打开 | 在浏览器中预览 |
| 📜 | VBA 助手 | 打开公式转换宏代码（重要功能） |
| 📋 | 复制到 Word | **核心操作按钮** |
| ◀️ | 收起面板 | 隐藏预览区以获得更大编辑空间 |

#### 源码视图的作用

切换到源码视图后，您可以：
- 检查 AI 生成的 HTML 结构是否符合预期
- 手动微调样式代码（适合高级用户）
- 排查格式问题的根源

#### 统计信息

预览区底部显示本次处理的统计数据：
- **单位**：自动转换的长度单位数量（px → pt）
- **表格**：处理的表格数量
- **清理**：移除的非法样式标签数量

[此处插入 UI 截图：实时预览区及工具栏]

---

## 三、核心功能操作流程

### 3.1 内容生成模式

**适用场景**：从零开始，让 AI 根据您的需求生成符合 Word 排版规范的专业文档。

**操作步骤**：

1. **确认模式**：确保底部模式按钮选中「生成」（✨ 图标高亮）
2. **输入需求**：在输入框中描述您的内容需求，例如：
   - "写一份关于机器学习的论文摘要，包含研究背景、方法、结果三部分"
   - "生成一个 5 行 3 列的数据对比表格，包含表头"
3. **发送请求**：按 Enter 键或点击发送按钮
4. **等待生成**：AI 将实时流式输出内容，您可以看到逐字生成的过程
5. **预览确认**：在右侧预览区查看渲染效果
6. **复制到 Word**：点击「复制到 Word」按钮

**重要提示**：粘贴到 Word 时，**务必选择「保留原格式」**（通常是粘贴选项的第一个图标）。

[此处插入 UI 截图：生成模式操作流程]

---

### 3.2 文档纠错模式

**适用场景**：对已有的 HTML 内容进行格式修正、样式统一、单位转换等优化。

**操作步骤**：

1. **切换模式**：点击底部「纠错」按钮（🔧 图标）
2. **准备内容**：确保预览区已有需要修正的内容（可从历史记录加载，或在生成模式先创建初稿）
3. **发起纠错**：点击发送按钮，AI 将自动分析当前文档并进行优化
4. **查看结果**：对比修正前后的变化
5. **复制使用**：满意后点击「复制到 Word」

**纠错模式的自动处理**：
- 将 `px` 单位统一转换为 `pt`
- 移除 `<style>` 标签和外链样式
- 补全表格边框和对齐属性
- 强制应用全局字体设置

[此处插入 UI 截图：纠错模式操作界面]

---

### 3.3 多对话管理

**适用场景**：同时处理多个不同的排版项目，互不干扰。

#### 新建对话

- 点击左侧导航栏的「➕」按钮
- 当前工作区将被清空，开始全新任务
- 之前的对话会自动保存到历史记录

#### 查看历史记录

1. 点击左侧导航栏的「🕐」图标进入历史记录页面
2. 使用搜索框快速定位特定对话
3. 每条记录显示：
   - 标题与创建时间
   - 模式标签（生成/纠错）
   - 操作按钮

#### 恢复历史对话

- **复制到 Word**：直接复制该记录的最终内容
- **继续对话**：加载完整对话上下文，继续与 AI 交互
- **查看源码**：展开查看原始 HTML 代码
- **删除记录**：移除不再需要的历史项

[此处插入 UI 截图：历史记录管理页面]

---

## 四、学术办公核武器（硬核功能说明）

### 4.1 VBA 宏转换助手

**这是 WordSmith AI 的杀手锏功能**，专门解决"AI 生成的 LaTeX 公式无法在 Word 中正常显示"这一行业难题。

#### 问题背景

AI 生成的数学公式通常采用 LaTeX 语法（如 `$E=mc^2$` 或 `$$\frac{a}{b}$$`），但 Word 原生不支持 LaTeX。直接粘贴后，公式会显示为乱码或纯文本。

#### 解决方案

WordSmith AI 内置了一段精心调试的 VBA 宏代码，能够将文档中的 LaTeX 公式**一键转换为 Word 原生公式对象（OMath）**。

#### 安装步骤

**第一步：打开 VBA 助手**

点击预览区工具栏的「📜 VBA 助手」按钮，弹出宏代码窗口。

[此处插入 UI 截图：VBA 助手弹窗]

**第二步：启用 Word 开发工具**

在 Word 中：文件 → 选项 → 自定义功能区 → 勾选右侧的「开发工具」

**第三步：进入 VBA 编辑器**

点击 Word 顶部「开发工具」选项卡 → 点击「Visual Basic」按钮（或按 `Alt + F11`）

**第四步：插入模块**

在左侧工程资源管理器中：右键点击 `Normal` → 插入 → 模块

**第五步：粘贴代码**

1. 回到 WordSmith AI，点击 VBA 助手中的「复制代码」按钮
2. 在 Word VBA 编辑器的新模块窗口中粘贴代码
3. 关闭 VBA 编辑器

#### 使用方法

1. 在 WordSmith AI 中点击「复制到 Word」，将内容粘贴到 Word 文档
2. 按 `Alt + F8` 打开宏对话框
3. 选择 `LatexToWordMath_Robust_Final`，点击「运行」
4. 文档中所有 `$...$` 和 `$$...$$` 格式的公式将瞬间转换为漂亮的 Word 原生公式

**转换效果**：
- 行内公式 `$E=mc^2$` → Word 行内公式对象
- 行间公式 `$$\frac{a}{b}$$` → Word 居中公式对象，自动渲染分数线、根号等专业样式

[此处插入 UI 截图：Word 中公式转换前后对比]

---

### 4.2 执行透明化（Debug 功能）

**功能定位**：让您能够"窥探" AI 的工作过程，确保它严格按照您的指令执行。

#### 为什么需要这个功能？

有时 AI 的输出可能不符合预期，您需要知道：
- 系统提示词是否正确注入？
- 自定义指令是否生效？
- 参考文档内容是否被正确引用？

#### 如何使用

1. 在对话消息区，找到 AI 回复消息
2. 点击消息右上角的「🐛」调试图标
3. 弹出窗口将显示发送给 AI 的**完整请求内容**，包括：
   - 系统提示词（排版协议）
   - 您的自定义指令
   - 参考文档内容
   - 用户输入

[此处插入 UI 截图：Debug 弹窗显示完整请求]

#### 调试技巧

- 如果 AI 没有遵循某条指令，检查该指令是否出现在请求内容中
- 如果格式不符合预期，查看系统提示词中的排版协议是否完整
- 历史记录页面同样支持查看每条记录的调试信息

---

## 五、常见问题与设置

### 5.1 如何配置 API Key

WordSmith AI 支持所有 OpenAI 兼容接口，包括 DeepSeek、Moonshot、SiliconFlow 等国内主流服务商。

**配置步骤**：

1. 点击左侧导航栏的「⚙️ 设置」图标
2. 切换到「AI 模型」选项卡
3. 选择 API 提供商（或选择「自定义 URL」手动输入）
4. 填写 API Key（通常以 `sk-` 开头）
5. 选择模型名称（如 `deepseek-chat`）
6. 点击「测试连接」验证配置是否正确

**支持的服务商**：
- DeepSeek
- ModelScope 魔搭
- SiliconFlow 硅基流动
- Zhipu 智谱清言
- Moonshot 月之暗面
- ByteDance 火山引擎
- Minimax
- 任意 OpenAI 兼容接口

[此处插入 UI 截图：AI 模型配置页面]

---

### 5.2 如何清空缓存或恢复出厂设置

**导出配置**（备份）：
1. 进入「设置」→「高级」选项卡
2. 点击「导出配置」按钮
3. 保存生成的 JSON 文件

**恢复出厂设置**：
1. 进入「设置」→「高级」选项卡
2. 点击「恢复出厂设置」按钮
3. 在确认对话框中点击「确认恢复」

**注意**：恢复出厂设置将清除所有自定义配置，包括 API 密钥、排版设置、历史记录等，此操作无法撤销。

[此处插入 UI 截图：高级设置页面]

---

### 5.3 应用页面的自定义调整

#### 收起/展开侧边栏

- **收起左侧智囊配置区**：点击左侧面板顶部的收起按钮
- **收起右侧预览区**：点击预览区工具栏最右侧的收起按钮
- **展开已收起的面板**：点击屏幕边缘出现的展开按钮

#### 护眼模式

1. 进入「设置」→「外观」选项卡
2. 开启「护眼模式」开关
3. 界面将降低对比度，减少视觉疲劳

#### 排版默认值

1. 进入「设置」→「外观」选项卡
2. 设置默认字体（如「SimSun」「微软雅黑」）
3. 设置默认字号（单位：pt）

这些设置将应用于所有新生成的文档。

#### 语言切换

1. 进入「设置」→「常规」选项卡
2. 选择「简体中文」或「English」

[此处插入 UI 截图：外观设置页面]

---

## 附录：快捷键速查表

| 快捷键 | 功能 | 适用场景 |
|--------|------|----------|
| `Enter` | 发送消息 | 编辑区输入框 |
| `Shift + Enter` | 换行 | 编辑区输入框 |
| `Alt + F11` | 打开 VBA 编辑器 | Word 中 |
| `Alt + F8` | 打开宏对话框 | Word 中 |
| `F5` | 运行宏 | Word VBA 编辑器中 |

---

## 附录：排版协议速览

WordSmith AI 内置的「排版协议」确保生成的 HTML 能够被 Word 完美识别：

| 规则 | 说明 |
|------|------|
| 仅使用行内样式 | 禁止 `<style>` 标签和外链样式表 |
| 长度单位统一为 pt | 自动将 px 转换为 pt（1pt ≈ 0.75px） |
| 表格强制居中 | `align="center"` + `width:440pt` |
| 数学公式保留原样 | `$...$` 和 `$$...$$` 不做渲染，由 VBA 宏处理 |

---

**文档版本**：1.0.0
**最后更新**：2026 年 2 月
**版权所有**：WordSmith AI 团队
